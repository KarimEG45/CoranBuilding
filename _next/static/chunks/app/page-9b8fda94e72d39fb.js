(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2047:(e,t,a)=>{Promise.resolve().then(a.bind(a,9343))},9343:(e,t,a)=>{"use strict";let r,s;a.r(t),a.d(t,{default:()=>ee});var l=a(5155),n=a(2115);let i={locked:"bg-slate-800 border-slate-700 text-slate-500",started:"bg-blue-900/60 border-blue-500/50 text-blue-300",revise:"bg-amber-900/60 border-amber-500/50 text-amber-300 animate-pulse",mastered:"bg-emerald-900/60 border-emerald-500/50 text-emerald-300"},c={locked:"bg-slate-600",started:"bg-blue-400",revise:"bg-amber-400",mastered:"bg-emerald-400"};function o(e){let{pageNumber:t,status:a,onClick:r}=e;return(0,l.jsxs)("button",{onClick:()=>r(t),className:"\n        relative flex flex-col items-center justify-center\n        w-full aspect-square rounded-md border\n        text-xs font-mono font-bold\n        transition-all active:scale-95 touch-manipulation\n        ".concat(i[a],"\n      "),"aria-label":"Page ".concat(t),children:[(0,l.jsx)("span",{className:"absolute top-1 right-1 w-1.5 h-1.5 rounded-full ".concat(c[a])}),(0,l.jsx)("span",{className:"text-[10px] leading-none",children:t})]})}function d(e){let{juzNumber:t,startPage:a,endPage:r,progress:s,onPageClick:n}=e,i=Array.from({length:r-a+1},(e,t)=>r-t),c=t>30?"Toit":"Juz' ".concat(String(t).padStart(2,"0"));return(0,l.jsxs)("div",{className:"flex items-stretch border-b border-slate-700/50 last:border-0",children:[(0,l.jsx)("div",{className:"flex-shrink-0 w-6 bg-slate-800/50 flex items-center justify-center",style:{writingMode:"vertical-rl",transform:"rotate(180deg)"},children:(0,l.jsx)("span",{className:"text-[9px] font-bold text-slate-500 tracking-widest uppercase",children:c})}),(0,l.jsx)("div",{className:"flex-1 grid grid-cols-5 sm:grid-cols-10 md:grid-cols-20 gap-1 p-1",children:i.map(e=>{var t,a;return(0,l.jsx)(o,{pageNumber:e,status:null!=(a=null==(t=s[e])?void 0:t.status)?a:"locked",onClick:n},e)})})]})}function u(e){let{progress:t,onPageClick:a}=e,r=[];r.push((0,l.jsx)(d,{juzNumber:31,startPage:601,endPage:604,progress:t,onPageClick:a},"roof"));for(let e=30;e>=1;e--){let s=20*e,n=s-19;r.push((0,l.jsx)(d,{juzNumber:e,startPage:n,endPage:s,progress:t,onPageClick:a},e))}return(0,l.jsxs)("div",{className:"flex flex-col w-full",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center py-3",children:[(0,l.jsx)("div",{className:"w-0.5 h-8 bg-slate-400"}),(0,l.jsx)("div",{className:"w-10 h-10 rounded-full border-2 border-slate-400 flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-gold-400 text-xs",children:"☽"})}),(0,l.jsx)("div",{className:"w-32 h-4 bg-slate-600 rounded-t-lg mt-1"}),(0,l.jsx)("span",{className:"text-[10px] text-slate-500 mt-1 tracking-widest uppercase",children:"Sommet — الذروة"})]}),(0,l.jsx)("div",{className:"bg-slate-900 border border-slate-700 rounded-t-lg overflow-hidden shadow-2xl",children:r}),(0,l.jsx)("div",{className:"w-full bg-gradient-to-b from-slate-700 to-slate-900 py-3 px-4 text-center rounded-b-lg",children:(0,l.jsx)("span",{className:"text-slate-400 text-[10px] tracking-widest uppercase font-bold",children:"الأساس — سورة الفاتحة"})})]})}let x=new Map;async function m(e){var t,a,r;if(x.has(e))return x.get(e);let s=await fetch("".concat("https://api.alquran.cloud/v1","/page/").concat(e,"/").concat("ar.uthmani"));if(!s.ok)throw Error("AlQuran API error: ".concat(s.status));let l=(await s.json()).data.ayahs,n={number:e,ayahs:l.map(e=>({number:e.number,text:e.text,surah:{number:e.surah.number,name:e.surah.name,englishName:e.surah.englishName}})),surahName:null!=(r=null==(a=l[0])||null==(t=a.surah)?void 0:t.name)?r:""};return x.set(e,n),n}function p(e){return e.replace(/[\u064B-\u065F\u0670]/g,"").replace(/[أإآٱ]/g,"ا").replace(/ؤ/g,"و").replace(/ئ/g,"ي").replace(/ة/g,"ه").replace(/ـ/g,"").trim()}let h=new Set(["ً","ٌ","ٍ"]),b=new Set(["َ","ُ","ِ","ْ","ّ","ً","ٌ","ٍ","ٓ","ٰ","ٔ","ٕ","ٖ","ٟ"]),g=new Set([..."قطبجد"]),f=new Set([..."ءهعحغخ"]),v=new Set([..."ينمو"]),j=new Set([..."لر"]),N=new Set(["ب"]),w=new Set([..."ءأإئؤآ"]);function y(e){return b.has(e)}function k(e){for(let t of e)if(!y(t))return t;return""}function S(e){if(!e)return"Izhar";let t=k(e);return!t||f.has(t)?"Izhar":N.has(t)?"Iqlab":v.has(t)?"Idgham avec Ghunnah":j.has(t)?"Idgham sans Ghunnah":"Ikhfa"}let M={1:{threshold:.15,enforceTajweed:!1},2:{threshold:.5,enforceTajweed:!0},3:{threshold:.8,enforceTajweed:!0}};function C(e){let{page:t,level:r,onResult:s}=e,[i,c]=(0,n.useState)("idle"),[o,d]=(0,n.useState)(0),[u,x]=(0,n.useState)(""),[m,b]=(0,n.useState)(!1),[f,v]=(0,n.useState)(""),j=(0,n.useRef)(null),C=(0,n.useRef)(null),I=(0,n.useRef)([]);(0,n.useEffect)(()=>{let e=new Worker(a.tu(new URL(a.p+a.u(154),a.b)),{type:void 0});return e.onmessage=e=>{let{type:t,status:a,message:r,progress:s,error:l,text:n}=e.data;"status"===t?(c(a),x(r)):"progress"===t?d(Math.round(100*s)):"result"===t?A(n):"error"===t&&(c("error"),x(l))},j.current=e,e.postMessage({type:"load",modelId:"Xenova/whisper-base"}),()=>e.terminate()},[]);let A=(0,n.useCallback)(e=>{v(e),c("done"),x("");let a=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e.map((r,s)=>{var l;return function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,s=M[a],l=function(e,t){if(!e&&!t)return 1;if(!e||!t)return 0;let a=e.length,r=t.length,s=Array.from({length:a+1},(e,t)=>Array.from({length:r+1},(e,a)=>0===t?a:0===a?t:0));for(let l=1;l<=a;l++)for(let a=1;a<=r;a++)s[l][a]=e[l-1]===t[a-1]?s[l-1][a-1]:1+Math.min(s[l-1][a],s[l][a-1],s[l-1][a-1]);return 1-s[a][r]/Math.max(a,r)}(p(e),p(t||"")),n=l>=s.threshold,i=[];if(s.enforceTajweed)for(let s of[...function(e){let t=[],a=[...e];for(let e=0;e<a.length;e++){let r=a[e];if(!g.has(r))continue;let s=!1,l=e+1;for(;l<a.length&&y(a[l]);)"ْ"===a[l]&&(s=!0),l++;let n=l>=a.length;if(s||n){let e=s?"Sughra":"Kubra";t.push({rule:"Qalqalah",subtype:e,letter:r,feedbackCorrect:"Qalqalah ".concat(e," bien appliqu\xe9e sur '").concat(r,"'."),feedbackMissing:"Appliquez le rebond (Qalqalah ".concat(e,") sur '").concat(r,"'.")})}}return t}(e),...function(e,t){let a=[],r=[...e];for(let e=0;e<r.length;e++)if("ن"===r[e]&&e+1<r.length&&"ْ"===r[e+1]){let e=S(t);a.push({rule:"Noon Sakinah",subtype:e,letter:"ن",feedbackCorrect:"Noon Sakinah (".concat(e,") bien appliqu\xe9e."),feedbackMissing:"Appliquez la r\xe8gle ".concat(e," sur le Noon Sakinah.")})}if([...r].some(e=>h.has(e))){let e=S(t);a.push({rule:"Tanween",subtype:e,letter:"",feedbackCorrect:"Tanween (".concat(e,") bien appliqu\xe9."),feedbackMissing:"Appliquez la r\xe8gle ".concat(e," sur le Tanween.")})}return a}(e,r),...function(e,t){let a=[],r=[...e];for(let e=0;e<r.length;e++)if("م"===r[e]&&e+1<r.length&&"ْ"===r[e+1]){let e=function(e){if(!e)return"Izhar Shafawi";let t=k(e);return"م"===t?"Idgham Shafawi":N.has(t)?"Ikhfa Shafawi":"Izhar Shafawi"}(t);a.push({rule:"Meem Sakinah",subtype:e,letter:"م",feedbackCorrect:"Meem Sakinah (".concat(e,") bien appliqu\xe9e."),feedbackMissing:"Appliquez la r\xe8gle ".concat(e," sur le Meem Sakinah.")})}return a}(e,r),...function(e){let t=[],a=[...e];for(let e=0;e<a.length;e++){let r=a[e];if("ن"!==r&&"م"!==r)continue;let s=!1,l=e+1;for(;l<a.length&&y(a[l]);)"ّ"===a[l]&&(s=!0),l++;if(s){let e="ن"===r?"Noon":"Meem";t.push({rule:"Ghunnah Mushaddada",subtype:e,letter:r,feedbackCorrect:"Ghunnah bien nasalis\xe9e sur le ".concat(e," Mushaddad (2 temps)."),feedbackMissing:"Nasalisez le ".concat(e," avec Shadda (Ghunnah 2 temps).")})}}return t}(e),...a>=3?function(e,t){let a=[],r=[...e];for(let e=1;e<r.length;e++){let s,l=r[e],n=r[e-1],i=!1;"ا"===l&&"َ"===n||"و"===l&&"ُ"===n?i=!0:"ي"===l&&"ِ"===n&&(i=!0),i&&(s=r.slice(e+1).filter(e=>!y(e)).some(e=>w.has(e))?"Madd Wajib Muttasil (4-5 temps)":t&&w.has(k(t))?"Madd Jaiz Munfasil (2-4 temps)":"Madd Tabii (2 temps)",a.push({rule:"Madd",subtype:s,letter:l,feedbackCorrect:"".concat(s," bien respect\xe9."),feedbackMissing:"Allongez correctement : ".concat(s,".")}))}return a}(e,r):[]]){let e=!!t,r=.6*!!e;e||3!==a||(n=!1),i.push({rule:s.rule,subtype:s.subtype,status:e?"correct":"absent",confidence:r,feedback:e?s.feedbackCorrect:s.feedbackMissing})}return{expected:e,transcribed:t||"",valid:n,confidence:Math.round(1e3*l)/1e3,rules:i}}(r,null!=(l=t[s])?l:"",a,e[s+1])})}(t.ayahs.map(e=>e.text).join(" ").split(/\s+/).filter(e=>e.length>0),e.split(/\s+/).filter(Boolean),r),l=a.length?a.filter(e=>e.valid).length/a.length:0;s(a,l)},[t,r,s]),D=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0});I.current=[];let t=new MediaRecorder(e,{mimeType:"audio/webm"});t.ondataavailable=e=>{e.data.size>0&&I.current.push(e.data)},t.onstop=E,t.start(),C.current=t,b(!0),c("recording"),x("Enregistrement...")}catch(e){c("error"),x("Microphone inaccessible.")}},E=async()=>{var e;c("transcribing"),x("Analyse de la r\xe9citation...");let t=new Blob(I.current,{type:"audio/webm"}),a=await t.arrayBuffer(),r=new AudioContext({sampleRate:16e3}),s=(await r.decodeAudioData(a)).getChannelData(0);null==(e=j.current)||e.postMessage({type:"transcribe",audio:s,language:"arabic"},[s.buffer])},B="loading"===i,P="idle"===i||"done"===i||"error"===i;return(0,l.jsxs)("div",{className:"flex flex-col items-center gap-4 p-4",children:[(0,l.jsxs)("div",{className:"text-center min-h-[3rem] flex flex-col justify-center",children:[B&&(0,l.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,l.jsx)("div",{className:"w-40 h-2 bg-slate-700 rounded-full overflow-hidden",children:(0,l.jsx)("div",{className:"h-full bg-gold-400 transition-all duration-300",style:{width:"".concat(o,"%")}})}),(0,l.jsxs)("p",{className:"text-slate-400 text-xs",children:[u," (",o,"%)"]})]}),"recording"===i&&(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"w-3 h-3 rounded-full bg-red-500 animate-pulse"}),(0,l.jsx)("span",{className:"text-red-400 text-sm font-medium",children:"R\xe9citation en cours..."})]}),"transcribing"===i&&(0,l.jsx)("p",{className:"text-blue-400 text-sm animate-pulse",children:u}),"error"===i&&(0,l.jsx)("p",{className:"text-red-400 text-sm",children:u})]}),(0,l.jsx)("button",{onClick:m?()=>{var e,t;null==(e=C.current)||e.stop(),null==(t=C.current)||t.stream.getTracks().forEach(e=>e.stop()),b(!1)}:D,disabled:B||"transcribing"===i,className:"\n          w-20 h-20 rounded-full border-4 flex items-center justify-center\n          text-3xl transition-all active:scale-95 touch-manipulation\n          disabled:opacity-40 disabled:cursor-not-allowed\n          ".concat(m?"bg-red-900/50 border-red-500 text-red-400 animate-pulse":P?"bg-slate-800 border-gold-500/50 text-gold-400 hover:bg-slate-700":"bg-slate-800 border-slate-600 text-slate-500","\n        "),"aria-label":m?"Arr\xeater la r\xe9citation":"Commencer la r\xe9citation",children:m?"⏹":"\uD83C\uDFA4"}),(0,l.jsx)("p",{className:"text-slate-500 text-xs text-center",children:m?"Appuyez pour terminer":P?"Appuyez pour r\xe9citer":""}),f&&(0,l.jsxs)("div",{className:"w-full bg-slate-800/50 rounded-lg p-3 border border-slate-700",children:[(0,l.jsx)("p",{className:"text-slate-400 text-[10px] uppercase tracking-wider mb-1",children:"Transcription"}),(0,l.jsx)("p",{className:"text-slate-200 text-sm text-right font-arabic leading-relaxed",dir:"rtl",children:f})]})]})}let I=(e,t)=>t.some(t=>e instanceof t),A=new WeakMap,D=new WeakMap,E=new WeakMap,B={get(e,t,a){if(e instanceof IDBTransaction){if("done"===t)return A.get(e);if("store"===t)return a.objectStoreNames[1]?void 0:a.objectStore(a.objectStoreNames[0])}return P(e[t])},set:(e,t,a)=>(e[t]=a,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function P(e){if(e instanceof IDBRequest){let t=new Promise((t,a)=>{let r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",l)},s=()=>{t(P(e.result)),r()},l=()=>{a(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",l)});return E.set(t,e),t}if(D.has(e))return D.get(e);let t=function(e){if("function"==typeof e)return(s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(z(this),t),P(this.request)}:function(...t){return P(e.apply(z(this),t))};return(e instanceof IDBTransaction&&function(e){if(A.has(e))return;let t=new Promise((t,a)=>{let r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",l),e.removeEventListener("abort",l)},s=()=>{t(),r()},l=()=>{a(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",l),e.addEventListener("abort",l)});A.set(e,t)}(e),I(e,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(e,B):e}(e);return t!==e&&(D.set(e,t),E.set(t,e)),t}let z=e=>E.get(e),T=["get","getKey","getAll","getAllKeys","count"],q=["put","add","delete","clear"],L=new Map;function R(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(L.get(t))return L.get(t);let a=t.replace(/FromIndex$/,""),r=t!==a,s=q.includes(a);if(!(a in(r?IDBIndex:IDBObjectStore).prototype)||!(s||T.includes(a)))return;let l=async function(e,...t){let l=this.transaction(e,s?"readwrite":"readonly"),n=l.store;return r&&(n=n.index(t.shift())),(await Promise.all([n[a](...t),s&&l.done]))[0]};return L.set(t,l),l}B=(e=>({...e,get:(t,a,r)=>R(t,a)||e.get(t,a,r),has:(t,a)=>!!R(t,a)||e.has(t,a)}))(B);let O=["continue","continuePrimaryKey","advance"],_={},W=new WeakMap,V=new WeakMap,F={get(e,t){if(!O.includes(t))return e[t];let a=_[t];return a||(a=_[t]=function(...e){W.set(this,V.get(this)[t](...e))}),a}};async function*G(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let a=new Proxy(t,F);for(V.set(a,t),E.set(a,z(t));t;)yield a,t=await (W.get(a)||t.continue()),W.delete(a)}function K(e,t){return t===Symbol.asyncIterator&&I(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&I(e,[IDBIndex,IDBObjectStore])}B=(e=>({...e,get:(t,a,r)=>K(t,a)?G:e.get(t,a,r),has:(t,a)=>K(t,a)||e.has(t,a)}))(B);let Q=null;async function U(){return Q||(Q=await function(e,t,{blocked:a,upgrade:r,blocking:s,terminated:l}={}){let n=indexedDB.open(e,1),i=P(n);return r&&n.addEventListener("upgradeneeded",e=>{r(P(n.result),e.oldVersion,e.newVersion,P(n.transaction),e)}),a&&n.addEventListener("blocked",e=>a(e.oldVersion,e.newVersion,e)),i.then(e=>{l&&e.addEventListener("close",()=>l()),s&&e.addEventListener("versionchange",e=>s(e.oldVersion,e.newVersion,e))}).catch(()=>{}),i}("coran-building",0,{upgrade(e){e.createObjectStore("progress",{keyPath:"page"}).createIndex("by-status","status");let t=e.createObjectStore("history",{keyPath:"timestamp"});t.createIndex("by-page","pageNumber"),t.createIndex("by-date","timestamp"),e.createObjectStore("settings",{keyPath:"key"})}}))}async function J(){let e=await U(),t=await e.getAll("progress"),a={};return t.forEach(e=>{a[e.page]=e}),a}async function H(e,t){var a;let r=await U(),s=await r.get("progress",e);await r.put("progress",{page:e,status:t,lastPracticed:Date.now(),recitationCount:(null!=(a=null==s?void 0:s.recitationCount)?a:0)+(null==s||s.status,0)})}async function X(e){let t=await U();if(await t.put("history",e),e.passed){let r=await t.get("progress",e.pageNumber),s=e.overallScore>=.8?"mastered":"started";if(!r||"mastered"!==r.status){var a;await t.put("progress",{page:e.pageNumber,status:s,lastPracticed:Date.now(),recitationCount:(null!=(a=null==r?void 0:r.recitationCount)?a:0)+1})}}}let $={1:"M\xe9morisation",2:"Tajweed Fondamental",3:"Ijaza Hafs"},Y=[{value:"locked",label:"Non d\xe9but\xe9",labelAr:"لم يبدأ",color:"bg-slate-700 text-slate-300"},{value:"started",label:"En cours",labelAr:"في التعلم",color:"bg-blue-900 text-blue-300"},{value:"revise",label:"\xc0 r\xe9viser",labelAr:"للمراجعة",color:"bg-amber-900 text-amber-300"},{value:"mastered",label:"Ma\xeetris\xe9",labelAr:"محفوظ",color:"bg-emerald-900 text-emerald-300"}];function Z(e){let{pageNumber:t,currentStatus:a,onClose:r,onStatusChange:s}=e,[i,c]=(0,n.useState)(null),[o,d]=(0,n.useState)(!0),[u,x]=(0,n.useState)(1),[p,h]=(0,n.useState)("page"),[b,g]=(0,n.useState)(null),[f,v]=(0,n.useState)(null),[j]=(0,n.useState)("/CoranBuilding");(0,n.useEffect)(()=>{d(!0),m(t).then(c).catch(console.error).finally(()=>d(!1))},[t]);let N=(0,n.useCallback)(async(e,r)=>{g(e),v(r);let l={pageNumber:t,level:u,words:e,overallScore:r,passed:r>=(1===u?.15:2===u?.5:.8),timestamp:Date.now()};await X(l),l.passed&&"locked"===a&&(await H(t,"started"),s(t,"started"))},[t,u,a,s]),w=async e=>{await H(t,e),s(t,e)};return(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex flex-col bg-slate-950 safe-area-inset",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-800 bg-slate-900",children:[(0,l.jsx)("button",{onClick:r,className:"text-slate-400 text-2xl leading-none touch-manipulation","aria-label":"Fermer",children:"←"}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("p",{className:"text-white font-bold text-sm",children:["Page ",t]}),i&&(0,l.jsx)("p",{className:"text-gold-400 text-xs font-arabic",dir:"rtl",children:i.surahName})]}),(0,l.jsx)("div",{className:"w-8"})]}),(0,l.jsx)("div",{className:"flex border-b border-slate-800 bg-slate-900",children:["page","practice"].map(e=>(0,l.jsx)("button",{onClick:()=>h(e),className:"flex-1 py-3 text-sm font-medium transition-colors touch-manipulation ".concat(p===e?"text-gold-400 border-b-2 border-gold-400":"text-slate-500"),children:"page"===e?"\uD83D\uDCD6 Page":"\uD83C\uDFA4 R\xe9citation"},e))}),(0,l.jsxs)("div",{className:"flex-1 overflow-y-auto",children:["page"===p&&(0,l.jsxs)("div",{className:"flex flex-col gap-4 p-4",children:[(0,l.jsx)("div",{className:"rounded-lg overflow-hidden border border-slate-700 bg-white",children:(0,l.jsx)("img",{src:"".concat(j,"/quran_pages/Quran_Page_").concat(String(t).padStart(3,"0"),".jpg"),alt:"Page ".concat(t," du Coran"),className:"w-full object-contain",loading:"lazy"})}),o?(0,l.jsx)("div",{className:"animate-pulse bg-slate-800 rounded-lg h-24"}):i?(0,l.jsxs)("div",{className:"bg-slate-900 rounded-lg p-4 border border-slate-700",children:[(0,l.jsx)("p",{className:"text-slate-400 text-[10px] uppercase tracking-wider mb-3",children:"Texte Uthmani"}),(0,l.jsx)("p",{className:"text-slate-100 text-lg leading-loose text-right font-arabic",dir:"rtl",children:i.ayahs.map(e=>e.text).join(" ")})]}):null,(0,l.jsxs)("div",{className:"bg-slate-900 rounded-lg p-4 border border-slate-700",children:[(0,l.jsx)("p",{className:"text-slate-400 text-[10px] uppercase tracking-wider mb-3",children:"Statut de m\xe9morisation"}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Y.map(e=>(0,l.jsxs)("button",{onClick:()=>w(e.value),className:"py-3 px-3 rounded-lg text-sm font-medium transition-all active:scale-95 touch-manipulation border ".concat(a===e.value?"".concat(e.color," border-current"):"bg-slate-800 text-slate-500 border-slate-700"),children:[(0,l.jsx)("span",{className:"block",children:e.label}),(0,l.jsx)("span",{className:"block text-xs opacity-60 font-arabic",dir:"rtl",children:e.labelAr})]},e.value))})]})]}),"practice"===p&&(0,l.jsxs)("div",{className:"flex flex-col gap-4 p-4",children:[(0,l.jsxs)("div",{className:"bg-slate-900 rounded-lg p-4 border border-slate-700",children:[(0,l.jsx)("p",{className:"text-slate-400 text-[10px] uppercase tracking-wider mb-3",children:"Niveau"}),(0,l.jsx)("div",{className:"flex gap-2",children:[1,2,3].map(e=>(0,l.jsxs)("button",{onClick:()=>x(e),className:"flex-1 py-2 rounded-lg text-xs font-bold transition-all touch-manipulation ".concat(u===e?"bg-gold-500 text-slate-900":"bg-slate-800 text-slate-400"),children:["N",e,(0,l.jsx)("span",{className:"block font-normal text-[9px] opacity-70 mt-0.5",children:$[e]})]},e))})]}),i&&(0,l.jsx)("div",{className:"bg-slate-900 rounded-lg border border-slate-700",children:(0,l.jsx)(C,{page:i,level:u,onResult:N})}),null!==f&&b&&(0,l.jsxs)("div",{className:"bg-slate-900 rounded-lg p-4 border border-slate-700",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("p",{className:"text-slate-400 text-[10px] uppercase tracking-wider",children:"R\xe9sultats"}),(0,l.jsxs)("span",{className:"text-lg font-bold ".concat(f>=.8?"text-emerald-400":f>=.5?"text-amber-400":"text-red-400"),children:[Math.round(100*f),"%"]})]}),(0,l.jsx)("div",{className:"w-full h-2 bg-slate-700 rounded-full overflow-hidden mb-4",children:(0,l.jsx)("div",{className:"h-full rounded-full transition-all duration-500 ".concat(f>=.8?"bg-emerald-400":f>=.5?"bg-amber-400":"bg-red-400"),style:{width:"".concat(100*f,"%")}})}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-1 justify-end",dir:"rtl",children:[b.slice(0,20).map((e,t)=>(0,l.jsx)("span",{className:"px-2 py-1 rounded text-sm font-arabic ".concat(e.valid?"bg-emerald-900/50 text-emerald-300":"bg-red-900/50 text-red-300"),title:"".concat(Math.round(100*e.confidence),"%"),children:e.expected},t)),b.length>20&&(0,l.jsxs)("span",{className:"text-slate-500 text-xs self-center",children:["+",b.length-20," mots..."]})]}),b.some(e=>e.rules.length>0)&&(0,l.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,l.jsx)("p",{className:"text-slate-400 text-[10px] uppercase tracking-wider",children:"R\xe8gles Tajweed"}),b.filter(e=>e.rules.length>0).slice(0,5).map((e,t)=>e.rules.map((e,a)=>(0,l.jsxs)("div",{className:"flex items-start gap-2 text-xs p-2 rounded ".concat("correct"===e.status?"bg-emerald-900/30":"bg-red-900/30"),children:[(0,l.jsx)("span",{children:"correct"===e.status?"✓":"✗"}),(0,l.jsx)("span",{className:"correct"===e.status?"text-emerald-400":"text-red-400",children:e.feedback})]},"".concat(t,"-").concat(a))))]})]})]})]})]})}function ee(){var e,t;let[a,r]=(0,n.useState)({}),[s,i]=(0,n.useState)({mastered:0,started:0,revise:0,total:604,percentage:0}),[c,o]=(0,n.useState)(null),[d,x]=(0,n.useState)(!0);(0,n.useEffect)(()=>{m()},[]);let m=async()=>{let e=await J();r(e),p(e),x(!1)},p=e=>{let t=0,a=0,r=0;Object.values(e).forEach(e=>{let{status:s}=e;"mastered"===s?t++:"started"===s?a++:"revise"===s&&r++}),i({mastered:t,started:a,revise:r,total:604,percentage:Math.round(t/604*100)})};return(0,l.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,l.jsxs)("header",{className:"sticky top-0 z-40 bg-slate-900/95 backdrop-blur border-b border-slate-800 safe-area-inset",children:[(0,l.jsxs)("div",{className:"px-4 py-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("h1",{className:"text-base font-bold text-white",children:["مبنى القرآن",(0,l.jsx)("span",{className:"text-slate-500 text-xs font-normal ml-2",children:"The Coran Building"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,l.jsxs)("span",{className:"text-gold-400 text-sm font-bold",children:[s.percentage,"%"]}),(0,l.jsx)("span",{className:"text-slate-500 text-xs",children:"محفوظ"})]})]}),(0,l.jsx)("div",{className:"mt-2 w-full h-1 bg-slate-800 rounded-full overflow-hidden",children:(0,l.jsx)("div",{className:"h-full bg-gradient-to-r from-emerald-600 to-gold-500 transition-all duration-500",style:{width:"".concat(s.percentage,"%")}})})]}),(0,l.jsx)("div",{className:"flex border-t border-slate-800 divide-x divide-slate-800",children:[{label:"Ma\xeetris\xe9",labelAr:"محفوظ",value:s.mastered,color:"text-emerald-400"},{label:"En cours",labelAr:"يُحفظ",value:s.started,color:"text-blue-400"},{label:"\xc0 r\xe9viser",labelAr:"مراجعة",value:s.revise,color:"text-amber-400"},{label:"Total",labelAr:"المجموع",value:604,color:"text-slate-400"}].map(e=>(0,l.jsxs)("div",{className:"flex-1 py-2 text-center",children:[(0,l.jsx)("p",{className:"text-base font-bold ".concat(e.color),children:e.value}),(0,l.jsx)("p",{className:"text-slate-500 text-[9px] uppercase tracking-wide",children:e.label})]},e.label))})]}),(0,l.jsx)("main",{className:"flex-1 px-2 py-4",children:d?(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,l.jsx)("div",{className:"w-8 h-8 border-2 border-gold-500 border-t-transparent rounded-full animate-spin"}),(0,l.jsx)("p",{className:"text-slate-500 text-sm",children:"Chargement..."})]})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"flex flex-wrap gap-2 mb-4 px-1",children:[{label:"Ma\xeetris\xe9",color:"bg-emerald-400"},{label:"\xc0 r\xe9viser",color:"bg-amber-400"},{label:"En cours",color:"bg-blue-400"},{label:"Non d\xe9but\xe9",color:"bg-slate-600"}].map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(e.color)}),(0,l.jsx)("span",{className:"text-slate-500 text-[10px]",children:e.label})]},e.label))}),(0,l.jsx)(u,{progress:a,onPageClick:o}),(0,l.jsx)("p",{className:"text-center text-slate-600 text-[10px] mt-4 italic",children:"Appuyez sur une page pour r\xe9citer • اضغط على صفحة للتلاوة"})]})}),c&&(0,l.jsx)(Z,{pageNumber:c,currentStatus:null!=(t=null==(e=a[c])?void 0:e.status)?t:"locked",onClose:()=>o(null),onStatusChange:(e,t)=>{r(a=>{var r,s;let l={...a,[e]:{...a[e],page:e,status:t,recitationCount:null!=(s=null==(r=a[e])?void 0:r.recitationCount)?s:0}};return p(l),l})}})]})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=2047)),_N_E=e.O()}]);